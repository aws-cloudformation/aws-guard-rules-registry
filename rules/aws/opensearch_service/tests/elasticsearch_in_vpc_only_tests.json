[
  {
    "name": "Rule is not run when ElasticSearch domain is not present",
    "input": {},
    "expectations": {
      "rules": {
        "ELASTICSEARCH_IN_VPC_ONLY": "SKIP"
      }
    }
  },
  {
    "name": "Rule passes when ElasticSearch domain has VPCOptions property",
    "input": {
      "Resources": {
        "ElasticsearchDomain": {
          "Type": "AWS::Elasticsearch::Domain",
          "Properties": {
            "DomainName": "test",
            "VPCOptions": {
              "SecurityGroupIds": ["sg-12345678"],
              "SubnetIds": ["subnet-12345678"]
            }
          }
        }
      }
    },
    "expectations": {
      "rules": {
        "ELASTICSEARCH_IN_VPC_ONLY": "PASS"
      }
    }
  },
  {
    "name": "Rule fails when ElasticSearch domain does not have VPCOptions property",
    "input": {
      "Resources": {
        "ElasticsearchDomain": {
          "Type": "AWS::Elasticsearch::Domain",
          "Properties": {
            "DomainName": "test"
          }
        }
      }
    },
    "expectations": {
      "rules": {
        "ELASTICSEARCH_IN_VPC_ONLY": "FAIL"
      }
    }
  }
]