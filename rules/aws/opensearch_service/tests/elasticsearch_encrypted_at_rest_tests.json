[
  {
    "name": "Rule is not run when ElasticSearch domain is not present",
    "input": {},
    "expectations": {
      "rules": {
        "ELASTICSEARCH_ENCRYPTED_AT_REST": "SKIP"
      }
    }
  },
  {
    "name": "Rule passes when ElasticSearch domain has server side encryption property is set to true",
    "input": {
      "Resources": {
        "ElasticsearchDomain": {
          "Type": "AWS::Elasticsearch::Domain",
          "Properties": {
            "DomainName": "test",
            "EncryptionAtRestOptions": {
              "Enabled": true
            }
          }
        }
      }
    },
    "expectations": {
      "rules": {
        "ELASTICSEARCH_ENCRYPTED_AT_REST": "PASS"
      }
    }
  },
  {
    "name": "Rule fails when ElasticSearch domain has server side encryption property is set to false",
    "input": {
      "Resources": {
        "ElasticsearchDomain": {
          "Type": "AWS::Elasticsearch::Domain",
          "Properties": {
            "DomainName": "test",
            "EncryptionAtRestOptions": {
              "Enabled": false
            }
          }
        }
      }
    },
    "expectations": {
      "rules": {
        "ELASTICSEARCH_ENCRYPTED_AT_REST": "FAIL"
      }
    }
  },
  {
    "name": "Rule fails when ElasticSearch domain has server side encryption property missing",
    "input": {
      "Resources": {
        "ElasticsearchDomain": {
          "Type": "AWS::Elasticsearch::Domain",
          "Properties": {
            "DomainName": "test"
          }
        }
      }
    },
    "expectations": {
      "rules": {
        "ELASTICSEARCH_ENCRYPTED_AT_REST": "FAIL"
      }
    }
  }
]