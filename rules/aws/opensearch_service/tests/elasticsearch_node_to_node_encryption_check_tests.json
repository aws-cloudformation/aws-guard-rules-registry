[
    {
      "name": "Rule is not run when ElasticSearch domain is not present",
      "input": {},
      "expectations": {
        "rules": {
          "ELASTICSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK": "SKIP"
        }
      }
    },
    {
      "name": "Rule passes when ElasticSearch domain has Node-to-Node Encryption property is set to true",
      "input": {
        "Resources": {
          "ElasticsearchDomain": {
            "Type": "AWS::Elasticsearch::Domain",
            "Properties": {
              "DomainName": "test",
              "NodeToNodeEncryptionOptions": {
                "Enabled": true
             }
            }
          }
        }
      },
      "expectations": {
        "rules": {
          "ELASTICSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK": "PASS"
        }
      }
    },
    {
      "name": "Rule fails when ElasticSearch domain has Node-to-Node Encryption property is set to false",
      "input": {
        "Resources": {
          "ElasticsearchDomain": {
            "Type": "AWS::Elasticsearch::Domain",
            "Properties": {
              "DomainName": "test",
              "NodeToNodeEncryptionOptions": {
                "Enabled": false
             }
            }
          }
        }
      },
      "expectations": {
        "rules": {
          "ELASTICSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK": "FAIL"
        }
      }
    },
    {
      "name": "Rule fails when ElasticSearch domain has Node-to-Node Encryption property missing",
      "input": {
        "Resources": {
          "ElasticsearchDomain": {
            "Type": "AWS::Elasticsearch::Domain",
            "Properties": {
              "DomainName": "test"
            }
          }
        }
      },
      "expectations": {
        "rules": {
          "ELASTICSEARCH_NODE_TO_NODE_ENCRYPTION_CHECK": "FAIL"
        }
      }
    }
  ]
