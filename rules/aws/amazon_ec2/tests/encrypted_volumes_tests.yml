###
# ENCRYPTED_VOLUMES tests
###
---

- name: No resources, SKIP
  input:
    Resources: {}
  expectations:
    rules:
      ENCRYPTED_VOLUMES: SKIP

- name: EC2 Volume KMS key is not empty, PASS
  input:
    Resources:
      ExampleVolume:
        Type: AWS::EC2::Volume
        Properties:
          AvailabilityZone: !Ref pAz
          Size: !Ref pSize
          kmskeyid: !Ref KeyId
  expectations:
    rules:
      ENCRYPTED_VOLUMES: PASS

- name: EC2 Volume KMS key is empty, FAIL
  input:
    Resources:
      ExampleVolume:
        Type: AWS::EC2::Volume
        Properties:
          AvailabilityZone: !Ref pAz
          Size: !Ref pSize
  expectations:
    rules:
      ENCRYPTED_VOLUMES: FAIL